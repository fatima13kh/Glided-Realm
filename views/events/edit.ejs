<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Edit <%= formData.title %> Event</title>
<link rel="stylesheet" href="/stylesheets/style.css">
</head>
<body>

    <%- include('../partials/_navbar.ejs') %>
    <div class="edit-page-background" style="background-image: url('<%= formData.backgroundImage || '/Assets/backgroundIMG.jpg' %>');">
<div class="edit-container">
  <% if (error) { %>
    <p class="error-message"><%= error %></p>
  <% } %>

  <h1>Edit <%= formData.title %> Event</h1>
  <form action="/events/<%= formData._id %>?_method=PUT" method="POST">
    
    <!-- Title -->
    <div>
      <label for="title">Title:</label>
      <input type="text" name="title" id="title" required pattern=".{3,}" 
        title="Title must be at least 3 characters long" value="<%= formData.title || '' %>" />
    </div>

    <!-- Type -->
    <div>
      <label for="type">Type:</label>
      <select name="type" id="type" required>
        <option value="">Select Event Type..</option>
        <option value="Venue" <%= formData.type === 'Venue' ? 'selected' : '' %>>Venue</option>
        <option value="Ballet" <%= formData.type === 'Ballet' ? 'selected' : '' %>>Ballet</option>
        <option value="Runway" <%= formData.type === 'Runway' ? 'selected' : '' %>>Runway</option>
        <option value="Art Gallery" <%= formData.type === 'Art Gallery' ? 'selected' : '' %>>Art Gallery</option>
      </select>
    </div>

    <!-- Background Image Display Only -->
<% if (formData.backgroundImage) { %>
  <div>
    <label>Background Image:</label>
    <div class="current-image">
      <img src="<%= formData.backgroundImage %>" alt="Current Background">
    </div>
  </div>
<% } %>

<!-- Ticket Image Display Only -->
<% if (formData.ticketImage) { %>
  <div>
    <label>Ticket Image:</label>
    <div class="current-image">
      <img src="<%= formData.ticketImage %>" alt="Current Ticket">
    </div>
  </div>
<% } %>


    <!-- Event Date -->
    <div class="full-width">
      <label for="eventDate">Event Date:</label>
      <input type="date" name="eventDate" id="eventDate" required 
        value="<%= formData.eventDate ? new Date(formData.eventDate).toISOString().slice(0,10) : '' %>" />
    </div>

    <!-- Start Time -->
    <div>
      <label for="startTime">Start Time:</label>
      <select name="startTime" id="startTime" required>
        <% times.forEach(time => { %>
          <option value="<%= time %>" <%= formData.startTime === time ? 'selected' : '' %>><%= time %></option>
        <% }) %>
      </select>
    </div>

    <!-- End Time -->
    <div>
      <label for="endTime">End Time:</label>
      <select name="endTime" id="endTime" required>
        <% times.forEach(time => { %>
          <option value="<%= time %>" <%= formData.endTime === time ? 'selected' : '' %>><%= time %></option>
        <% }) %>
      </select>
    </div>

    <!-- Location -->
    <div>
      <label for="location">Location:</label>
      <input type="text" name="location" id="location" required value="<%= formData.location || '' %>" />
    </div>

    <!-- Booking Phone -->
    <div>
      <label for="bookingPhoneNumber">Booking Phone Number:</label>
      <input type="tel" name="bookingPhoneNumber" id="bookingPhoneNumber" required pattern="[0-9]{8,10}" 
        title="Phone number must be 8 to 10 digits" value="<%= formData.bookingPhoneNumber || '' %>" />
    </div>

    <!-- Price -->
    <div>
      <label for="price">Price:</label>
      <input type="number" name="price" id="price" min="1" value="<%= formData.price || '' %>" />
    </div>

    <!-- Ticket Quantity -->
    <div>
      <label for="ticketQuantity">Ticket Quantity:</label>
      <input type="number" name="ticketQuantity" id="ticketQuantity" min="1" value="<%= formData.ticketQuantity || '' %>" />
    </div>

    <!-- Description -->
    <div class="full-width">
      <label for="description">Description:</label>
      <textarea name="description" id="description" rows="5" required><%= formData.description || '' %></textarea>
    </div>

    <!-- Performers -->
    <div class="full-width">
      <label for="performers">Performers:</label>
      <input type="text" name="performers" id="performers" placeholder="Comma-separated" 
        value="<%= Array.isArray(formData.performers) ? formData.performers.join(', ') : (formData.performers || '') %>" />
    </div>

    <!-- Submit -->
    <button type="submit">Update Event</button>
  </form>
</div>
</div>
</body>
<footer>
  <p>&copy; 2025 Glided Realm. All rights reserved.</p>
</footer>
</html>